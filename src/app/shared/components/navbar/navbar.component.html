<header class="header" [class.scrolled]="isScrolled">
  <div class="navbar-container">
    <div class="logo">
      <h1>DBMS</h1>
    </div>

    <nav class="nav-links">
      <a routerLink="/" (click)="scrollToTop()" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" >Home</a>
      <a routerLink="/our-story" routerLinkActive="active">Our Story</a>
      <a routerLink="/catalog" routerLinkActive="active">Catalog</a>
      <a routerLink="/browse" routerLinkActive="active">Browse</a>
      <a (click)="scrollToContact()" routerLinkActive="active">Contact</a>
    </nav>

    <div class="navbar-actions">
      <!-- âœ¨ FIX: Using (ngModelChange) for robust event handling -->
      <z-switch [ngModel]="isDarkMode" (ngModelChange)="toggleTheme($event)" class="theme-switch"></z-switch>
      <div class="auth-buttons" *ngIf="!(isAuthenticated$ | async)">
        <a routerLink="/login" class="login-button">Login</a>
        <a routerLink="/register" class="signup-button">Sign Up</a>
      </div>
      <div class="profile-menu-container" *ngIf="(isAuthenticated$ | async) && (currentUser$ | async) as user">
        <button (click)="toggleProfileMenu()" class="profile-avatar-button">
          <img [src]="user.avatarUrl || 'https://i.pravatar.cc/40'" alt="User Avatar" class="profile-avatar">
        </button>
        <div class="profile-dropdown" *ngIf="isProfileMenuOpen">
          <a routerLink="/user-profile" class="dropdown-item">Profile</a>
          <button (click)="logout()" class="dropdown-item">Logout</button>
        </div>
      </div>
    </div>
    
  </div>
</header>


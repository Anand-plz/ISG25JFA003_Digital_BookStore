<app-navbar></app-navbar>
<div class="profile-container">
  <!-- Profile Header -->
  <header class="profile-header">
    <img [src]="currentUser.avatarUrl" alt="User Profile Picture" class="profile-avatar">
    <h1 class="welcome-message">Welcome, {{ currentUser.name }}!</h1>
  </header>

  <main class="profile-content">
    <!-- Left Column: Password Change -->
    <div class="profile-card password-card">
      <h2>Change Password</h2>
      <form (ngSubmit)="changePassword()" class="password-form">
        <!-- Old Password -->
        <div class="form-group">
          <label for="old-password">Old Password</label>
          <div class="password-input-wrapper">
            <input [type]="showOldPassword ? 'text' : 'password'" id="old-password" [(ngModel)]="oldPassword" name="oldPassword" required>
            <button type="button" class="toggle-password" (click)="showOldPassword = !showOldPassword">
              <!-- Show/Hide Icon -->
              <svg *ngIf="!showOldPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
              <svg *ngIf="showOldPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/></svg>
            </button>
          </div>
        </div>
        <!-- New Password -->
        <div class="form-group">
          <label for="new-password">New Password</label>
          <div class="password-input-wrapper">
            <input [type]="showNewPassword ? 'text' : 'password'" id="new-password" [(ngModel)]="newPassword" name="newPassword" required>
            <button type="button" class="toggle-password" (click)="showNewPassword = !showNewPassword">
              <!-- Show/Hide Icon -->
              <svg *ngIf="!showNewPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
              <svg *ngIf="showNewPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/></svg>
            </button>
          </div>
        </div>
        <!-- Confirm New Password -->
        <div class="form-group">
          <label for="confirm-new-password">Confirm New Password</label>
          <div class="password-input-wrapper">
            <input [type]="showConfirmPassword ? 'text' : 'password'" id="confirm-new-password" [(ngModel)]="confirmNewPassword" name="confirmNewPassword" required>
            <button type="button" class="toggle-password" (click)="showConfirmPassword = !showConfirmPassword">
              <!-- Show/Hide Icon -->
              <svg *ngIf="!showConfirmPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
              <svg *ngIf="showConfirmPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/></svg>
            </button>
          </div>
        </div>
        <p *ngIf="passwordMismatchError" class="error-message">Passwords do not match!</p>
        <button type="submit" class="change-btn">Change Password</button>
      </form>
    </div>

    <!-- Right Column: Tabbed Sections -->
    <div class="profile-card info-card">
      <nav class="tabs">
        <button (click)="setActiveSection('orders')" [class.active]="activeSection === 'orders'">My Orders</button>
        <button (click)="setActiveSection('cart')" [class.active]="activeSection === 'cart'">My Cart</button>
        <button (click)="setActiveSection('address')" [class.active]="activeSection === 'address'">My Addresses</button>
      </nav>

      <div class="tab-content" [ngSwitch]="activeSection">
        <!-- Orders Section -->
        <section *ngSwitchCase="'orders'" class="orders-list">
          <div *ngFor="let order of currentUser.orders" class="order-item">
            <div class="order-details">
              <strong>Order #{{ order.id }}</strong>
              <span>Date: {{ order.date }}</span>
            </div>
            <div class="order-summary">
              <span>Total: ${{ order.total.toFixed(2) }}</span>
              <span class="status" [ngClass]="order.status.toLowerCase()">{{ order.status }}</span>
            </div>
          </div>
        </section>

        <!-- Cart Section -->
        <section *ngSwitchCase="'cart'" class="cart-list">
          <div *ngFor="let item of currentUser.cart" class="cart-item">
            <img [src]="item.imageUrl" alt="{{ item.name }}" class="item-image">
            <div class="item-details">
              <strong>{{ item.name }}</strong>
              <span>Quantity: {{ item.quantity }}</span>
            </div>
            <span class="item-price">${{ (item.price * item.quantity).toFixed(2) }}</span>
          </div>
          <div class="cart-total">
            <strong>Total:</strong>
            <strong>${{ cartTotal.toFixed(2) }}</strong>
          </div>
        </section>

        <!-- Address Section -->
        <section *ngSwitchCase="'address'" class="address-list">
          <div *ngFor="let address of currentUser.addresses" class="address-item">
            <div class="address-details">
              <strong>{{ address.type }} <span *ngIf="address.isDefault" class="default-badge">(Default)</span></strong>
              <p>{{ address.street }}, {{ address.city }}, {{ address.zip }}</p>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>
</div>

